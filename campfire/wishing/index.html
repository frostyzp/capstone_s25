<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>on washing, hoping</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Import map for PlayHTML -->
    <script type="importmap">
    {
      "imports": {
        "playhtml": "https://unpkg.com/playhtml/dist/playhtml.js"
      }
    }
    </script>
    
    <!-- Initialize PlayHTML -->
    <script type="module">
      import * as playhtml from 'playhtml';
      playhtml.init();
    </script>

    <!-- Three.js dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/FontLoader.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/geometries/TextGeometry.js"></script>
    
    <!-- Rita.js for poem generation -->
    <script src="https://unpkg.com/rita@3.1.3/dist/rita.min.js"></script>
    
    <!-- Our scripts -->
    <script src="wishing.js" defer></script>
    <script src="buttons.js" defer></script>
    <script src="3d-text.js" defer></script>

    <style>
      .page {
        transition: opacity 0.8s ease-in-out;
      }
      .page.hidden {
        opacity: 0;
        pointer-events: none;
      }
      .page.visible {
        opacity: 1;
      }
    </style>
</head>

<body data-playhtml>
    <svg>
        <filter id="wavy">
        <feTurbulence id="turbulence" type="turbulence" numOctaves="1" 
        result="NOISE"></feTurbulence>
         <feDisplacementMap in="SourceGraphic" in2="NOISE" scale="50">
         </feDisplacementMap>
        <animate xlink:href="#turbulence" attributeName="baseFrequency" dur="60s" keyTimes="0;0.5;1"
      values="0.01 0.02;0.02 0.04;0.01 0.02" repeatCount="indefinite"></animate>
       </filter>
      </svg>


      <div class="landingPage page visible">
        <div class="background-image"></div>
        _.-'~~`~~'-._
        .-~` skip  ping  `~-. 
      .'    st   o ne           `.
        `~-.____________.-~`
        _.-'~~`~~'-._
        .-~` skip  ping  `~-. 
      .'    st   o ne           `.
        `~-.____________.-~`
        <br>
        _.-'~~`~~'-._
        .-~` skip  ping  `~-. 
      .'    st   <br>o ne           `.
        `~-.____________.-~`
        <br>        

        <button id="landingPageButton">[ enter the 3d2 ]</button>

    </div>


    <!--  ########################################################################################################### -->

    <div class="secondPage page hidden" id="second-page">
        <div id="input-container">
            <div class="instructions"> <br> Skip your rock into the universe. Tilt your vessel to see the ripples. </div>
            <div id="wish-input-container">
                <textarea id="wish-input" placeholder="describe a space you dream about living in"></textarea>
                <div id="arrow"> ^ <br>
                |<br>
                |</div>
                <button id="submit-wish">[ hold onto wish ]</button>
                <pre id="skippingRock" data-can-move>
                  _.-'~~`~~'-._
               .-~` skipping  `~-. 
             .'    rocks           `.
               `~-.____________.-~`
                </pre>
            </div>
        </div>
    </div>

    <!-- Third page for 3D visualization -->
    <div class="thirdPage page hidden" id="third-page">
        <div id="ripple-container">
            <div id="ripple-1"></div>
        </div>
    </div>

    <script>
      // Function to switch pages
      function switchToPage(pageClass) {
        console.log('Switching to page:', pageClass); // Add logging
        document.querySelectorAll('.page').forEach(page => {
          page.classList.add('hidden');
          page.classList.remove('visible');
        });
        
        const targetPage = document.querySelector('.' + pageClass);
        if (targetPage) {
            targetPage.classList.remove('hidden');
            targetPage.classList.add('visible');
            console.log('Page switched successfully'); // Add logging
        } else {
            console.error('Target page not found:', pageClass); // Add error logging
        }
      }
      
      // Add event listener to transition to second page with the button
      document.getElementById('landingPageButton').addEventListener('click', function() {
        switchToPage('secondPage');
      });

      // Make switchToPage available globally
      window.switchToPage = switchToPage;
    </script>

</body>

</html>
